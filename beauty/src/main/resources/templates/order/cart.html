<!--
날짜 : 2023/03/01
이름 : 김동근
내용 : 포트폴리오01 HTML wishlist
-->
<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org"
				xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
				xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
    <head>
        <meta charset="UTF-8">
        <th:block th:replace="~{/_config :: indexConfigFragment}"></th:block>
        
        <!-- Private index, headfoot settings -->
        <!-- font -->
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Nanum+Gothic&family=Noto+Sans+KR:wght@300&family=Quicksand:wght@300&display=swap" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300&display=swap" rel="stylesheet">
        <!-- library -->
        <script type="module" src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.esm.js"></script>
        <script nomodule src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.js"></script>
        <link rel="stylesheet" type="text/css" href="https://vendor-cdn.imweb.me/fonts/im-icon/style.css?1671430692">
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
        <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
        <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@48,400,0,0" />
        <!-- css -->
        <link rel="stylesheet" th:href="@{/css/myshop/init.css}">
        <link rel="stylesheet" th:href="@{/css/myshop/myPage.css}">
        <link rel="stylesheet" th:href="@{/css/order/cart.css}">
        <!-- js -->
        <script th:src="@{/js/order/cart.js}"></script>
        
        <title>Cart</title>
        <script>
            $(function(){
                $('[data-toggle="popover"]').popover(); 
            });
        </script>
    </head>
    <body>
        <div id="wrap">
            <!-- 헤더 -->
            <th:block th:replace="~{/_header :: headerFragment}"></th:block>
            
            <!-- 메인 -->
            <main>
                <div class="mainBackgorund">
                    <div class="mainContent">
                        <!-- 콘텐츠 -->
                        <section class="myContent">
                            
                            <!-- 각 페이지 내용 -->
                            <a class="btn" th:href="@{/order/test}">테스트</a>
                            <div class="cartFrame">
                                <section class="nav">
                                    <p class="current"><span>1</span>장바구니</p> 
                                    <p><span>2</span> 주문/결제</p> 
                                    <p><span>3</span> 주문완료</p>
                                </section>
                                <div class="cartListHead">
                                    장바구니
                                    <span class="headCount" id="headCount" th:text="${#lists.size(cartList)}"></span>
                                </div>

                                <!-- 카트 테이블 -->
                                <article class="cartList">
                                    <table border="1">
                                        <thead>
                                            <tr>
                                                <th><input name="chkAll" type="checkbox"></th>
                                                <th></th>
                                                <th>상품 정보</th>
                                                <th>판매가</th>
                                                <th>수량</th>
                                                <th>적립</th>
                                                <th>합계</th>
                                                <th>배송비</th>
                                                <th>선택</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <!-- 아이템 반복 -->
                                            <th:block th:each="cart:${cartList}">
                                            <tr>
                                                <td><input name="chkCart" type="checkbox" th:value="${cart.cartNo}"></td>
                                                <td> <a th:href="@{/product/view(prodNo=${cart.prodNo})}"> <img th:src="@{/img/}+${cart.thumb1}" alt=""> </a> </td>
                                                <td>
                                                    <strong><a th:href="@{/product/view(prodNo=${cart.prodNo})}" th:text="${cart.prodName}"></a></strong><br>
                                                    <span>[옵션: <span th:text="${cart.prodName}"></span>]<br></span>
                                                    <span><a class="btn" href="#">옵션변경</a></span>
                                                </td>
                                                <td>
                                                	<!-- 할인 상품 구분 -->
                                                    <th:block th:if="${cart.discount == 0}">
                                                    	<span class="price" th:text="${#numbers.formatInteger(cart.getSalePrice, 0, 'COMMA')}"></span>원
                                                	</th:block>
                                                	<th:block th:unless="${cart.discount == 0}">
                                                    	<span class="oriPrice" th:text="${#numbers.formatInteger(cart.price, 0, 'COMMA')}"></span>원 <br>
                                                    	<span class="price" th:text="${#numbers.formatInteger(cart.getSalePrice, 0, 'COMMA')}"></span>원 <span class="discount">20</span>
                                                	</th:block>
                                                </td>
                                                <td>
                                                    <span class="countFrame">
                                                        <input id="count" type="text" th:value="${cart.count}" readonly="readonly">
                                                        <a class="btnIncrease" href="#"><img src="//img.echosting.cafe24.com/skin/base/common/btn_quantity_up.gif" alt="수량증가"></a>
                                                        <a class="btnDecrease" href="#"><img src="//img.echosting.cafe24.com/skin/base/common/btn_quantity_down.gif" alt="수량감소"></a>
                                                    </span>
                                                </td>
                                                <!-- 비회원 포인트란 - 표시 -->
                                                <td><span th:text="${#numbers.formatInteger(cart.point * cart.count, 0, 'COMMA')}"></span>원</td>
                                                <td><span th:text="${#numbers.formatInteger(cart.getTotalPrice, 0, 'COMMA')}"></span>원</td>
												<!-- 첫행에만 나올것 동적처리를 위해 css적용 -->
                                                <td class="deliveryInfo" rowspan="100"> 
                                                	<!-- 배송비 체크 -->
                                                    <span th:if="${#aggregates.sum(cartList.![getTotalPrice]) >= 50000}">무료</span>
                                                    <span th:unless="${#aggregates.sum(cartList.![getTotalPrice]) >= 50000}">2500원</span>
                                                    <label data-toggle="popover" title="조건부 무료배송" data-placement="top" data-html="true"
                                                        data-content="기본 배송비 2,500원 <br/> 50,000원 이상 구매 시 무료배송"> 
                                                        <span id="deliIcon" class="material-symbols-outlined">help</span> 
                                                    </label>
                                                </td>
                                                <td>
                                                    <a class="btn btnTableOrder" href="#">주문하기</a>
                                                    <a class="btn btnTableAddWish" href="#">관심상품등록</a>
                                                    <a class="btn btnTableDelete" href="#">삭제</a>
                                                	<input type="hidden" name="prodNo" th:value="${cart.prodNo}">
                                                </td>
                                            </tr>
                                            </th:block>
                                            <!-- 아이템 반복 끝-->
                                            
                                        </tbody>
                                    </table>
                                    <!-- 삭제 버튼 -->
                                    <div class="cartBtns">
                                        <a id="btnDeleteSelectedCart" class="btn" href="#">선택상품 삭제</a>
                                        <a id="btnDeleteAllCart" class="btn" href="#">비우기</a>
                                    </div>
                                </article>
                                <!-- Total 테이블-->
                                <th:block th:unless="${#lists.size(cartList) == 0}"> 
                                <div>
                                    <table class="totalTable">
                                        <thead>
                                            <tr><th>총 주문 상품 <span id="totalCount" th:text="${#lists.size(cartList)}"></span>개</th></tr>
                                        </thead>
                                        <tbody>
                                            <tr><td>
                                                <div class="priceInfoContainer">
                                                    <div class="cartPrice">
                                                        <div class="priceWrap">
                                                            <p id="totalPrice" th:text="${#numbers.formatInteger(#aggregates.sum(cartList.![price*count]), 0, 'COMMA')}+'원'"></p>
                                                            <p>상품금액</p>
                                                        </div>
                                                    </div>
                                                    <div class="deliPrice">
                                                        <div>
                                                            <i class="im-icon im-ico-plus-plain"></i>
                                                        </div>
                                                        <div class="priceWrap">
                                                            <p id="totalDelivery" th:if="${#aggregates.sum(cartList.![getTotalPrice]) >= 50000}">무료</p>
                                                            <p id="totalDelivery" th:unless="${#aggregates.sum(cartList.![getTotalPrice]) >= 50000}">2500원</p>
                                                            <p>배송비</p>
                                                        </div>
                                                    </div>
                                                    <div class="disPrice">
                                                        <div>
                                                            <i class="im-icon im-ico-minus-plain"></i>
                                                        </div>
                                                        <div class="priceWrap">
                                                            <p id="totalDisPrice" th:text="${#numbers.formatInteger(#aggregates.sum(cartList.![disPrice*count]), 0, 'COMMA')}+'원'"></p>
                                                            <p>상품 할인금액</p>
                                                        </div>
                                                    </div>
                                                    <div class="totalPrice">
                                                        <div>
                                                            <i class="im-icon im-ico-equals-plain"></i>
                                                        </div>
                                                        <div class="priceWrap">
                                                            <p 	id="totalTotalPrice" th:if="${#aggregates.sum(cartList.![getTotalPrice]) >= 50000}" 
                                                            	th:text="${#numbers.formatInteger(#aggregates.sum(cartList.![getTotalPrice]), 0, 'COMMA')}+'원'"></p>
                                                            <p 	id="totalTotalPrice" th:unless="${#aggregates.sum(cartList.![getTotalPrice]) >= 50000}" 
                                                            	th:text="${#numbers.formatInteger(#aggregates.sum(cartList.![getTotalPrice])+2500, 0, 'COMMA')}+'원'"></p>
                                                            <p>총 주문금액</p>
                                                        </div>
                                                    </div>
                                                </div>
                                            </td></tr>
                                        </tbody>
                                    </table>
                                    </th:block>
                                </div>
                                <!-- 주문 버튼 -->
                                <div class="cartBtns">
                                    <a class="btnOrder select" href="#">선택상품주문</a>
                                    <a class="btnOrder all" href="#">전체상품주문</a>
                                    <a class="keepShopping" href="#">계속 쇼핑하기</a>
                                </div>
                                <!-- 카트테이블 위시리스트-->
                                <div class="wishListFrame">
                                    <div class="wishListHead">
                                        위시리스트
                                        <a class="btn" th:href="@{/myshop/wishlist}">더보기</a>
                                    </div>
                                    <article class="wishList">
										<div class="emptyWish" th:if="${#lists.size(wishList) == 0}">찜한 상품이 없습니다.</div>
	                                    <!-- 아이템 반복 -->
	                                    <th:block  th:each="wish:${wishList}">
	                                    <div class="item" th:if="${wishStat.index < 5}">
	                                        <div class="itemThumb">
	                                            <a th:href="@{/product/view(prodNo=${wish.prodNo})}">
	                                                <!--
														<img th:src="@{/image/}+${wish.thumb1}" alt="">
	                                                -->
	                                                <img th:src="@{/img/}+${wish.thumb1}" alt="">
	                                            </a>
	                                            <a class="delete" th:href="@{/order/deleteSelectedWishFromCart(wishNo=${wish.wishNo})}">x</a>
	                                        </div>
	                                        <div class="itemInfo">
	                                            <a th:href="@{/product/view(prodNo=${wish.prodNo})}" th:text="${wish.prodName}"></a>
	                                            <span class="price" th:text="${#numbers.formatInteger(wish.getSalePrice, 0, 'COMMA')}"></span>
	                                        </div>
	                                    </div>
	                                    </th:block>
	                                    <!-- 아이템 반복 종료 -->
                                    </article>
                                </div>
                            </div>
                        </section>
                    </div>
                </div>
            </main>

            <!-- 푸터 -->
            <th:block th:replace="~{/_footer :: footerFragment}"></th:block>
        </div>
    </body>
</html>